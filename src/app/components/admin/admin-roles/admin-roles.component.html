<div class="container py-3 roles-container">
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 gap-2">
    <div>
      <h1 class="fw-bold mb-1">Roles y permisos</h1>
      <p class="text-muted mb-0">Gestioná las solicitudes de clubes pendientes</p>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-outline-secondary btn-sm" (click)="goBack()">
        <i class="bi bi-arrow-left"></i> Volver al panel
      </button>
      <button class="btn btn-danger btn-sm" (click)="logout()">
        <i class="bi bi-box-arrow-right me-1"></i> Cerrar sesión
      </button>
    </div>
  </div>

  <div class="card pending-card">
    <div class="card-header d-flex flex-column flex-md-row justify-content-between align-items-md-center">
      <div>
        <h5 class="mb-1">Solicitudes de clubes pendientes</h5>
        <small class="text-muted">Aprobá para habilitar el rol de club a los usuarios</small>
      </div>
      <span class="badge bg-secondary mt-2 mt-md-0">{{ pendingClubs.length }} solicitudes</span>
    </div>
    <div class="card-body">
      <div *ngIf="pendingLoading" class="text-center text-muted py-3">
        Cargando solicitudes...
      </div>

      <div *ngIf="pendingError" class="alert alert-danger py-2">
        {{ pendingError }}
      </div>

      <div *ngIf="approveMessage" class="alert alert-success py-2">
        {{ approveMessage }}
      </div>

      <div *ngIf="!pendingLoading && pendingClubs.length === 0 && !pendingError" class="text-muted text-center py-3">
        No hay solicitudes pendientes por el momento.
      </div>

      <div class="table-responsive" *ngIf="pendingClubs.length > 0">
        <table class="table table-hover pending-table align-middle mb-0">
          <thead>
            <tr>
              <th>Club</th>
              <th>CUIT/CUIL</th>
              <th>Ubicación</th>
              <th>Estado</th>
              <!-- <th>Fechas</th> -->
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let club of pendingClubs">
              <td>
                <div class="fw-semibold">{{ club.nombreFantasia || club.razonSocial || 'Sin nombre' }}</div>
                <small class="text-muted">ID: {{ club.idClub }}</small>
              </td>
              <td>{{ club.cuitCuil }}</td>
              <td>{{ club.localidad }}, {{ club.provincia }}</td>
              <td>
                <div class="estadoLabel">
                  <span [class]="estadoClass(club.idEstadoClub)">
                    {{ estadoLabel(club.idEstadoClub) }}
                  </span>
                </div>
              </td>
              <!-- <td>
                <div class="small text-muted">
                  <div><strong>Solicitud:</strong> {{ formatDate(club.createdAt) }}</div>
                  <div><strong>Último cambio:</strong> {{ formatDate(club.updatedAt) }}</div>
                </div>
              </td> -->
              <!-- <td>
                <button class="btn btn-success btn-sm w-100"
                  [disabled]="approvingClubId === club.idClub"
                  (click)="approveClub(club)">
                  <span *ngIf="approvingClubId === club.idClub" class="spinner-border spinner-border-sm me-1"></span>
                  Aprobar
                </button>
              </td> -->
              <td>
                <div class="d-flex gap-2">
                  <button class="btn btn-success btn-sm flex-fill"
                    [disabled]="approvingClubId === club.idClub"
                    (click)="approveClub(club)">
                    <span *ngIf="approvingClubId === club.idClub" class="spinner-border spinner-border-sm me-1"></span>
                    Aprobar
                  </button>

                  <button class="btn btn-outline-danger btn-sm flex-fill"
                    [disabled]="approvingClubId === club.idClub"
                    (click)="rejectClub(club)">
                    Rechazar
                  </button>
                </div>
              </td>

            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
